% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/contrast_test_tidy.r
\name{contrast_test_tidy}
\alias{contrast_test_tidy}
\title{Planned contrast test for tidy-format data using explicit sum-of-squares decomposition}
\usage{
contrast_test_tidy(
  dataset,
  paired = FALSE,
  alpha = 0.05,
  inc_allvar = FALSE,
  do_round = TRUE,
  autocorrect_unbalance = TRUE
)
}
\arguments{
\item{dataset}{A data frame or tibble with exactly four columns,
in the following order:
(1) participant ID,
(2) independent variable (condition),
(3) dependent variable (response),
(4) contrast weights.}

\item{paired}{Logical. If \code{TRUE}, a within-participants
(repeated-measures) contrast is performed.
If \code{FALSE}, an independent-groups contrast is performed.}

\item{alpha}{Significance level used for the \code{sig} column.}

\item{inc_allvar}{Logical. If \code{TRUE}, return intermediate
sums of squares and mean squares.
If \code{FALSE}, return only commonly reported statistics.}

\item{do_round}{Logical. If \code{TRUE}, round output values
for compact display.}

\item{autocorrect_unbalance}{Logical.
If \code{TRUE} and \code{paired = FALSE}, contrast weights
are automatically converted from condition-level coefficients
to observation-level coefficients when group sizes are unbalanced,
so that the tested contrast corresponds to the standard
planned contrast on condition means.}
}
\value{
A data frame containing at least:
\itemize{
\item \code{effect} Contrast label.
\item \code{df1}, \code{df2} Numerator and denominator degrees of freedom.
\item \code{F} F statistic.
\item \code{p} p-value.
\item \code{sig} Significance code (\code{"*"} or \code{"ns"}).
\item \code{eta2} Eta-squared.
\item \code{peta2} Partial eta-squared.
\item \code{cohens_f} Cohen's f.
}
If \code{inc_allvar = TRUE}, sum-of-squares and mean squares are also returned.
}
\description{
This function performs a planned contrast test on tidy-format data
(participant × condition × response × contrast weight),
by explicitly constructing sum-of-squares components.
}
\details{
The implementation is intentionally written in a step-by-step
decomposition style (grand mean, condition effects, residuals,
contrast component, error component) so that students can directly
inspect how a 1-degree-of-freedom contrast emerges as a regression
on contrast weights and how its F statistic is constructed.

Although equivalent numerical results can be obtained by fitting
a linear model, this function is designed for educational purposes
to make the internal structure of contrast tests transparent.

The function assumes that contrast weights are constant within each
condition. If their sum is not zero, weights are automatically centered.

Internally, the contrast is treated as a 1-degree-of-freedom regression
on contrast weights, and the F statistic is constructed from explicit
sum-of-squares decomposition rather than by calling \code{lm()}.

In unbalanced designs, results may differ slightly from textbook
planned contrasts based on condition means, because the contrast
is implemented as a 1-df regression on observation-level contrast weights.

This design is intended to support teaching of contrast tests
and ANOVA sum-of-squares structure.
}
\examples{
# Example with independent groups
df <- data.frame(
  id = rep(1:30, each = 1),
  cond = rep(c("A","B","C"), each = 10),
  y = rnorm(30),
  w = rep(c(-1, 0, 1), each = 10)
)

contrast_test_tidy(df)

}
